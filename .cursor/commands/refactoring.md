# リファクタリング作業開始コマンド

このコマンドは、リファクタリング作業を開始するための専用コマンドです。

## 使用方法

```
/refactoring <Issue URL または Issue番号> <簡単な説明>
```

**例**:
- `/refactoring #45 App.tsxの分割`
- `/refactoring https://github.com/owner/repo/issues/45 App.tsxの分割`
- `/refactoring #45` (説明なしの場合はIssueタイトルを使用)

## 実行内容

このコマンドを実行すると、以下の作業を自動的に実行します：

### 1. Issue情報の抽出
- Issue URL または Issue番号から Issue 番号を抽出
- Issue番号は PR作成時に自動的に紐付けられます

### 2. ブランチ作成
- ベースブランチ: `develop`
- ブランチ命名規則: `feature/refactoring-<説明のスラッグ化>`
- 例: `feature/refactoring-app-component`

### 3. 作業タイプの設定
- 作業タイプ: **リファクタリング**
- コミットプレフィックス: `refactor:`
- PR先: `develop` ブランチ

### 4. ワークフロー実行
`@development-workflow.mdc` の全ステップを自動実行：
1. ✅ ブランチ作成（developから）
2. ✅ 既存テスト実行（変更前）
3. ✅ コード変更実施
4. ✅ **ユーザー確認（必須）** - ステップ3.5
5. ✅ ビルド確認
6. ✅ 単体テスト再実行
7. ✅ テスト追加・変更（必要に応じて）
8. ✅ E2Eテスト再実行
9. ✅ 最終確認（ESLint、TypeScript）
10. ✅ コミット＆プッシュ
11. ✅ PR作成（develop ブランチへ、Issue番号を紐付け）

## リファクタリングの定義

以下のような作業がリファクタリングに該当します：
- コードの構造改善（ファイル分割、関数抽出など）
- 重複コードの削減
- コードの可読性向上
- パフォーマンス最適化（機能変更なし）
- テストの追加・改善
- 型定義の改善
- 命名の改善

**重要**: 機能の動作は変更しないこと。リファクタリング前後で動作が同一であることを確認してください。

## コミットメッセージ形式

```
refactor: <主要ファイル>を<変更内容>
```

**例**:
- `refactor: App.tsxを分割してカスタムフックを抽出`
- `refactor: calculator.tsを関数単位にファイル分割`
- `refactor: 型定義をブランデッド型に変更`

## PR作成時の自動設定

- **PRタイトル**: `refactor: <変更内容>`
- **PR先**: `develop` ブランチ
- **Issue紐付け**: `Closes #<Issue番号>` が自動的に追加されます
- **品質保証結果**: 単体テスト、E2Eテスト、ビルド、ESLintの結果が自動的に記載されます

## 注意事項

1. **テストは必ず全て合格すること**
   - リファクタリングは動作を変更しないため、既存テストが全て合格する必要があります
   - 失敗する場合はリグレッションの可能性があります

2. **E2Eテストも必ず実行**
   - UIレベルの動作確認も重要です

3. **段階的な変更を推奨**
   - 大規模なリファクタリングは複数のPRに分割してください

4. **カバレッジを維持**
   - リファクタリング後もテストカバレッジが低下しないように注意してください

---

**このコマンドは `@development-workflow.mdc` と `@create-pull-request.mdc` の全ルールに従って実行されます。**

