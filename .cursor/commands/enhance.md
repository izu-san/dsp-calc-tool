# 機能追加作業開始コマンド

このコマンドは、機能追加・機能拡張作業を開始するための専用コマンドです。

## 使用方法

```
/enhance <Issue URL または Issue番号> <簡単な説明>
```

**例**:
- `/enhance #92 採掘速度計算機能`
- `/enhance https://github.com/owner/repo/issues/92 採掘速度計算機能`
- `/enhance #92` (説明なしの場合はIssueタイトルを使用)

## 実行内容

このコマンドを実行すると、以下の作業を自動的に実行します：

### 1. Issue情報の抽出
- Issue URL または Issue番号から Issue 番号を抽出
- Issue番号は PR作成時に自動的に紐付けられます

### 2. ブランチ作成
- ベースブランチ: `develop`
- ブランチ命名規則: `feature/<機能名のスラッグ化>`
- 例: `feature/mining-calculator`

### 3. 作業タイプの設定
- 作業タイプ: **機能エンハンス**
- コミットプレフィックス: `feat:`
- PR先: `develop` ブランチ

### 4. ワークフロー実行
`@development-workflow.mdc` の全ステップを自動実行：
1. ✅ ブランチ作成（developから）
2. ✅ 既存テスト実行（変更前）
3. ✅ コード変更実施（新機能追加）
4. ✅ **ユーザー確認（必須）** - ステップ3.5
5. ✅ ビルド確認
6. ✅ 単体テスト再実行
7. ✅ **新機能のテスト追加（必須）**
8. ✅ E2Eテスト再実行
9. ✅ 最終確認（ESLint、TypeScript）
10. ✅ コミット＆プッシュ
11. ✅ PR作成（develop ブランチへ、Issue番号を紐付け）

## 機能エンハンスの定義

以下のような作業が機能エンハンスに該当します：
- 新機能の追加
- 既存機能の拡張
- 新しいUIコンポーネントの追加
- 新しい計算ロジックの追加
- 新しいデータ表示機能の追加
- 新しい設定項目の追加
- ユーザビリティの向上（機能追加を伴う場合）

## 実装の進め方

### 1. 設計フェーズ
- 型定義から開始（`src/types/` に追加）
- インターフェースを設計
- データフローを設計

### 2. 実装フェーズ
- ビジネスロジックを実装（`src/lib/` に追加）
- UIコンポーネントを実装（`src/components/` に追加）
- ストアを追加・更新（必要に応じて）

### 3. テストフェーズ
- 単体テストを追加（`src/**/__tests__/*.test.ts(x)`）
- E2Eシナリオを追加（`tests/e2e/*.spec.ts`）
- カバレッジ目標: 新規コードは85%以上

### 4. ドキュメントフェーズ
- コード内のコメントを充実させる
- 複雑なロジックには仕様コメントを追加

## コミットメッセージ形式

```
feat: <機能名>
```

**例**:
- `feat: 採掘速度計算機能を追加`
- `feat: レシピ比較モーダルを追加`
- `feat: JSONエクスポート機能を追加`
- `feat: What-Ifシミュレーターを追加`

## PR作成時の自動設定

- **PRタイトル**: `feat: <機能名>`
- **PR先**: `develop` ブランチ
- **Issue紐付け**: `Closes #<Issue番号>` が自動的に追加されます
- **品質保証結果**: 単体テスト、E2Eテスト、ビルド、ESLintの結果が自動的に記載されます

## 注意事項

1. **新機能のテストは必須**
   - 新しい関数・モジュールには必ず単体テストを追加してください
   - カバレッジ目標: 新規コードは85%以上

2. **E2Eテストも追加を検討**
   - ユーザーフローに影響がある場合、E2Eテストを追加してください
   - `tests/e2e/` に新しいシナリオを追加

3. **段階的な実装を推奨**
   - 大規模な機能は複数のPRに分割してください
   - 各PRで独立してテスト可能にしてください

4. **既存機能への影響を確認**
   - 新機能が既存機能に影響を与えないか確認してください
   - 全てのE2Eテストが合格することを確認してください

5. **ユーザビリティを考慮**
   - 新機能は直感的で使いやすいUIを心がけてください
   - 必要に応じて説明やツールチップを追加してください

6. **パフォーマンスを考慮**
   - 新機能がアプリケーション全体のパフォーマンスに影響しないか確認してください
   - 必要に応じてメモ化やレイジーロードを検討してください

## 実装パターンの参照

新機能を実装する際は、以下のドキュメントを参照してください：
- `@TypeScript.mdc` - TypeScript実装パターン
- `@coding.mdc` - 設計原則
- プロジェクトルート `.cursor/rules/` - プロジェクト固有のルール

## コードレビュー時のチェックポイント

- [ ] 型定義が適切か
- [ ] ビジネスロジックがUIから分離されているか
- [ ] テストカバレッジが十分か
- [ ] E2Eテストが追加されているか（必要に応じて）
- [ ] コードコメントが充実しているか
- [ ] ESLintエラーがないか
- [ ] TypeScriptコンパイルエラーがないか
- [ ] パフォーマンスへの影響がないか

---

**このコマンドは `@development-workflow.mdc` と `@create-pull-request.mdc` の全ルールに従って実行されます。**

